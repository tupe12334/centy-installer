name: Release

on:
  push:
    tags:
      - 'v*'

permissions:
  contents: write

jobs:
  release:
    name: Create Release
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Get version from tag
        id: get_version
        run: echo "version=${GITHUB_REF#refs/tags/}" >> $GITHUB_OUTPUT

      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: ${{ steps.get_version.outputs.version }}
          name: ${{ steps.get_version.outputs.version }}
          body: |
            ## Centy Installer ${{ steps.get_version.outputs.version }}

            ### Quick Install

            ```bash
            curl -fsSL https://github.com/centy-io/centy-installer/releases/latest/download/install.sh | sh
            ```

            ### What gets installed

            - `centy-daemon` - Centy daemon service
            - `centy-tui` - Centy terminal UI

            ### Installation location

            - Binaries: `~/.centy/versions/<binary>/<version>/<binary>`
            - Symlinks: `~/.centy/bin/<binary>`

            ### Environment variables

            - `BINARIES` - Space-separated list of binaries to install (default: "centy-daemon centy-tui")
            - `VERSION` - Specific version to install (default: latest)
          draft: false
          prerelease: false
          files: |
            install.sh
